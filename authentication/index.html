<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>Authentication - Mezzanine REST API</title>
      
      
      
        <link rel="canonical" href="http://gcushen.github.io/mezzanine-api/authentication/">
      
      
        <meta name="author" content="George Cushen">
      
    
    <meta property="og:url" content="http://gcushen.github.io/mezzanine-api/authentication/">
    <meta property="og:title" content="Mezzanine REST API">
    <meta property="og:image" content="http://gcushen.github.io/mezzanine-api/authentication//../img/mezzanine_api_logo.png">
    <meta name="apple-mobile-web-app-title" content="Mezzanine REST API">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
      <link rel="apple-touch-icon" href="../img/mezzanine_api_logo.png">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../assets/images/favicon-e565ddfa3b.ico">
    <link rel="icon" type="image/x-icon" href="../assets/images/favicon-e565ddfa3b.ico">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../assets/fonts/icon.eot?52m981');
      	src: url('../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../assets/stylesheets/application-20d5debb47.css">
    
    
      
      
      
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,700|Roboto+Mono">
      <style>
        body, input {
          font-family: 'Roboto', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Roboto Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
      <link rel="stylesheet" href="../css/extra.css">
    
    <script src="../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class=" ">
    
      
      
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
          </span>
        
        Authentication
      </div>
    </div>
    
      
      <div class="button button-twitter" role="button" aria-label="Twitter">
        <a href="https://twitter.com/GeorgeCushen" title="@GeorgeCushen on Twitter" target="_blank" class="toggle-button icon icon-twitter"></a>
      </div>
    
    
      
      <div class="button button-github" role="button" aria-label="GitHub">
        <a href="https://github.com/gcushen" title="@gcushen on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
      </div>
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="https://github.com/gcushen/mezzanine-api" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="../img/mezzanine_api_logo.png">
        </div>
      
      <div class="name">
        <strong>Mezzanine REST API </strong>
        
          <br>
          gcushen/mezzanine-api
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            
            <a href="https://github.com/gcushen/mezzanine-api/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/gcushen/mezzanine-api/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Mezzanine API" href="..">
      Mezzanine API
    </a>
    
  </li>

          
            
  <li>
    <a class="current" title="Authentication" href="./">
      Authentication
    </a>
    
      
        
      
      
        <ul>
          
            <li class="anchor">
              <a title="OAuth2 authentication" href="#oauth2-authentication">
                OAuth2 authentication
              </a>
            </li>
          
            <li class="anchor">
              <a title="Basic authentication" href="#basic-authentication">
                Basic authentication
              </a>
            </li>
          
            <li class="anchor">
              <a title="Session authentication" href="#session-authentication">
                Session authentication
              </a>
            </li>
          
        </ul>
      
    
  </li>

          
            
  <li>
    <a class="" title="Release Notes" href="../release-notes/">
      Release Notes
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Client SDK" href="../client/">
      Client SDK
    </a>
    
  </li>

          
        </ul>
        
          <hr>
          <span class="section">The author</span>
          <ul>
            
              
              <li>
                <a href="https://twitter.com/GeorgeCushen" target="_blank" title="@GeorgeCushen on Twitter">
                  @GeorgeCushen on Twitter
                </a>
              </li>
            
            
              
              <li>
                <a href="https://github.com/gcushen" target="_blank" title="@gcushen on GitHub">
                  @gcushen on GitHub
                </a>
              </li>
            
          </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
          <h1 id="authentication">Authentication</h1>
<p>There are three options for authenticating with the API. The most appropriate option can be determined by considering if the API client is:</p>
<ul>
<li>another Django app running on the site (such as the built-in browsable API)? Use <em>session</em> authentication.</li>
<li>a desktop/web/mobile client accessing the site externally? Use <em>OAuth2</em> authentication.</li>
<li>a very simple external client mainly for development and debugging? Use <em>basic</em> authentication.</li>
</ul>
<p>In the following sections, we explore how these different approaches can be used. It is assumed that you have already created a superuser account in Mezzanine.</p>
<h2 id="oauth2-authentication">OAuth2 authentication</h2>
<p>OAuth2 is the industry standard for API authentication and should be used to handle external API clients. 
With OAuth authentication, users can login to the OAuth2 App Manager and generate access tokens to authorize clients to access the API on their behalf. 
This access can be revoked by users at any point, for example if the access token falls into the wrong hands. 
A fresh access token can then be easily generated if neccessary.</p>
<h3 id="creating-an-app">Creating an app</h3>
<p>Open up the local OAuth2 App Manager at <a href="http://127.0.0.1:8000/api/oauth2/applications/register/">http://127.0.0.1:8000/api/oauth2/applications/register/</a> in your browser. (If you are using API version &lt;= 0.3.0, you may experience a 404 error. To resolve this, add the line <code>LOGIN_URL = "/api/auth/login/"</code> to your <code>settings.py</code>.)</p>
<p>OAuth2 provides <em>client types</em> and <em>grant types</em> for different API use cases. The client types consider whether a secret can be kept safe on the API client. They are defined as:</p>
<ul>
<li><strong>Confidential</strong> for server-side apps running on a web server</li>
<li><strong>Public</strong> for JavaScript apps running in a web browser, desktop PC/laptop apps, or mobile apps</li>
</ul>
<p>And the available grant types are as follows:</p>
<ul>
<li><strong>Authorization Code</strong> for server-side apps</li>
<li><strong>Implicit</strong> for browser-based or mobile apps</li>
<li><strong>Password</strong> for logging in with a username and password</li>
<li><strong>Client credentials</strong> for apps to access their own account, outside the context of any specific user</li>
</ul>
<p>Thus, for a mobile client app, we would choose the <em>Public</em> client type and the <em>Implicit</em> grant type. </p>
<p>However, for this example, we consider a server-side app. Go ahead and register a new OAuth application. Just enter a reference name, choose <code>confidential</code> client type and 
<code>...password-based</code> authorization grant type:</p>
<p><img alt="OAuth Screenshot" src="../img/oauth_register.png" /></p>
<h3 id="receiving-an-access-token">Receiving an Access Token</h3>
<p>Request your access token to use for API authentication:</p>
<pre class="code"><code>$ curl -X POST -H &quot;Accept: application/json; indent=4&quot; \
  -d &quot;grant_type=password&amp;username=&lt;username&gt;&amp;password=&lt;password&gt;&quot; -u&quot;&lt;client_id&gt;:&lt;client_secret&gt;&quot; \
  http://localhost:8000/api/oauth2/token/</code></pre>


<p>For <code>client_id</code> and <code>client_secret</code>, copy and paste those that you were given in the previous step. The <code>username</code> and 
<code>password</code> are the credentials of the Mezzanine user you wish to login as. You will get a JSON response like:</p>
<pre class="code"><code>{
    &quot;access_token&quot;: &quot;**&lt;your_access_token&gt;**&quot;,
     ...
}</code></pre>


<p>For security, tokens currently last two weeks and then users will need to re-authenticate with your app once the token expires, or automatically renew the access token using the refresh token flow.</p>
<h3 id="testing-an-app-as-client-owner">Testing an app as client owner</h3>
<p>The following test should <em>fail</em> (i.e. no user listings shown) if you are not currently authenticated:</p>
<pre class="code"><code>$ curl http://localhost:8000/api/users

{
    &quot;detail&quot;: &quot;Authentication credentials were not provided.&quot;
}</code></pre>


<p>The following authenticated test should <em>succeed</em> and show you a list of users if you registered OAuth with a 
<em>superuser</em> account:    </p>
<pre class="code"><code>$ curl -H &quot;Authorization: Bearer &lt;your_access_token&gt;&quot; http://localhost:8000/api/users</code></pre>


<p>You can also test your access token by entering it at the top of your local interactive API Resource Documentation page at <a href="http://127.0.0.1:8000/api/docs/">http://127.0.0.1:8000/api/docs/</a>.</p>
<h2 id="basic-authentication">Basic authentication</h2>
<p>Due to the complexity of OAuth2 authentication, basic authentication can be useful during development. 
However, basic authentication requires trusting your sensitive credentials with API client applications and passing your username and password on every request, so it is strongly discouraged for production use.</p>
<h3 id="testing">Testing</h3>
<p>The following test should <em>fail</em> (i.e. no user listings shown) if you are not currently authenticated:</p>
<pre class="code"><code>$ curl http://localhost:8000/api/users

{
    &quot;detail&quot;: &quot;Authentication credentials were not provided.&quot;
}</code></pre>


<p>The following authenticated test should <em>succeed</em> and show you a list of users if you enter credentials of a Mezzanine <em>superuser</em> account:    </p>
<pre class="code"><code>$ curl --user '&lt;your_username&gt;:&lt;your_password&gt;' http://localhost:8000/api/users</code></pre>


<h2 id="session-authentication">Session authentication</h2>
<p>Session authentication is enabled primarily for the Browsable Web API. If you wish to use session based authentication for write access as well as read access, you will need to setup a valid CSRF token for any PUT or POST requests. See the <a href="https://docs.djangoproject.com/en/dev/ref/csrf/#ajax">Django CSRF documentation</a> for more details.</p>
          <aside class="copyright" role="note">
            
              Copyright &copy; 2016 <a href="https://twitter.com/GeorgeCushen">George Cushen</a>. &ndash;
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href=".." title="Mezzanine API">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Mezzanine API
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../release-notes/" title="Release Notes">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                Release Notes
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '..';
      var repo_id  = 'gcushen/mezzanine-api';
    </script>
    <script src="../assets/javascripts/application-997097ee0c.js"></script>
    
    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
        /* General initialization */
        ga('create', 'UA-62992791-1', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
        /* Track outbound links */
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
        /* Register handler to log search on blur */
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    
  </body>
</html>