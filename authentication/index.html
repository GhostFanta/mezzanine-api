



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="RESTful web API for Mezzanine CMS">
      
      
        <link rel="canonical" href="http://gcushen.github.io/mezzanine-api/authentication/">
      
      
        <meta name="author" content="George Cushen">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.4">
    
    
      
        <title>Authentication - Mezzanine REST API</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#ef5350">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../css/extra.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="red" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../#authentication" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://gcushen.github.io/mezzanine-api" title="Mezzanine REST API" class="md-header-nav__button md-logo">
          
            <img src="../img/mezzanine_api_logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Mezzanine REST API
              </span>
              <span class="md-header-nav__topic">
                Authentication
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/gcushen/mezzanine-api/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="http://gcushen.github.io/mezzanine-api" title="Mezzanine REST API" class="md-nav__button md-logo">
      
        <img src="../img/mezzanine_api_logo.png" width="48" height="48">
      
    </a>
    Mezzanine REST API
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/gcushen/mezzanine-api/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Mezzanine API" class="md-nav__link">
      Mezzanine API
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Authentication
      </label>
    
    <a href="./" title="Authentication" class="md-nav__link md-nav__link--active">
      Authentication
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#oauth2-authentication" title="OAuth2 authentication" class="md-nav__link">
    OAuth2 authentication
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-an-app" title="Creating an app" class="md-nav__link">
    Creating an app
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#receiving-an-access-token" title="Receiving an Access Token" class="md-nav__link">
    Receiving an Access Token
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-an-app-as-client-owner" title="Testing an app as client owner" class="md-nav__link">
    Testing an app as client owner
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-authentication" title="Basic authentication" class="md-nav__link">
    Basic authentication
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#testing" title="Testing" class="md-nav__link">
    Testing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-authentication" title="Session authentication" class="md-nav__link">
    Session authentication
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../client/" title="Client SDK" class="md-nav__link">
      Client SDK
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../cli/" title="Remote CLI" class="md-nav__link">
      Remote CLI
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#oauth2-authentication" title="OAuth2 authentication" class="md-nav__link">
    OAuth2 authentication
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-an-app" title="Creating an app" class="md-nav__link">
    Creating an app
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#receiving-an-access-token" title="Receiving an Access Token" class="md-nav__link">
    Receiving an Access Token
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-an-app-as-client-owner" title="Testing an app as client owner" class="md-nav__link">
    Testing an app as client owner
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-authentication" title="Basic authentication" class="md-nav__link">
    Basic authentication
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#testing" title="Testing" class="md-nav__link">
    Testing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-authentication" title="Session authentication" class="md-nav__link">
    Session authentication
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/gcushen/mezzanine-api/edit/master/docs/authentication.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="authentication">Authentication<a class="headerlink" href="#authentication" title="Permanent link">&para;</a></h1>
<p>There are three options for authenticating with the API. The most appropriate option can be determined by considering if the API client is:</p>
<ul>
<li>another Django app running on the site (such as the built-in browsable API)? Use <em>session</em> authentication.</li>
<li>a desktop/web/mobile client accessing the site externally? Use <em>OAuth2</em> authentication.</li>
<li>a very simple external client mainly for development and debugging? Use <em>basic</em> authentication.</li>
</ul>
<p>In the following sections, we explore how these different approaches can be used. It is assumed that you have already created a superuser account in Mezzanine.</p>
<h2 id="oauth2-authentication">OAuth2 authentication<a class="headerlink" href="#oauth2-authentication" title="Permanent link">&para;</a></h2>
<p>OAuth2 is the industry standard for API authentication and should be used to handle external API clients. 
With OAuth authentication, users can login to the OAuth2 App Manager and generate access tokens to authorize clients to access the API on their behalf. 
This access can be revoked by users at any point, for example if the access token falls into the wrong hands. 
A fresh access token can then be easily generated if neccessary.</p>
<h3 id="creating-an-app">Creating an app<a class="headerlink" href="#creating-an-app" title="Permanent link">&para;</a></h3>
<p>Open up the local OAuth2 App Manager at <a href="http://127.0.0.1:8000/api/oauth2/applications/register/">http://127.0.0.1:8000/api/oauth2/applications/register/</a> in your browser. (If you are using API version &lt;= 0.3.0, you may experience a 404 error. To resolve this, add the line <code>LOGIN_URL = "/api/auth/login/"</code> to your <code>settings.py</code>.)</p>
<p>OAuth2 provides <em>client types</em> and <em>grant types</em> for different API use cases. The client types consider whether a secret can be kept safe on the API client. They are defined as:</p>
<ul>
<li><strong>Confidential</strong> for server-side apps running on a web server</li>
<li><strong>Public</strong> for JavaScript apps running in a web browser, desktop PC/laptop apps, or mobile apps</li>
</ul>
<p>And the available grant types are as follows:</p>
<ul>
<li><strong>Authorization Code</strong> for server-side apps</li>
<li><strong>Implicit</strong> for browser-based or mobile apps</li>
<li><strong>Password</strong> for logging in with a username and password</li>
<li><strong>Client credentials</strong> for apps to access their own account, outside the context of any specific user</li>
</ul>
<p>Thus, for a mobile client app, we would choose the <em>Public</em> client type and the <em>Implicit</em> grant type. </p>
<p>However, for this example, we consider a server-side app. Go ahead and register a new OAuth application. Just enter a reference name, choose <code>confidential</code> client type and 
<code>...password-based</code> authorization grant type:</p>
<p><img alt="OAuth Screenshot" src="../img/oauth_register.png" /></p>
<h3 id="receiving-an-access-token">Receiving an Access Token<a class="headerlink" href="#receiving-an-access-token" title="Permanent link">&para;</a></h3>
<p>Request your access token to use for API authentication:</p>
<div class="codehilite"><pre><span></span>$ curl -X POST -H <span class="s2">&quot;Accept: application/json; indent=4&quot;</span> <span class="se">\</span>
  -d <span class="s2">&quot;grant_type=password&amp;amp;username=&amp;lt;username&amp;gt;&amp;amp;password=&amp;lt;password&amp;gt;&quot;</span> -u<span class="s2">&quot;&amp;lt;client_id&amp;gt;:&amp;lt;client_secret&amp;gt;&quot;</span> <span class="se">\</span>
  http://localhost:8000/api/oauth2/token/
</pre></div>


<p>For <code>client_id</code> and <code>client_secret</code>, copy and paste those that you were given in the previous step. The <code>username</code> and 
<code>password</code> are the credentials of the Mezzanine user you wish to login as. You will get a JSON response like:</p>
<div class="codehilite"><pre><span></span>{
    &quot;access_token&quot;: &quot;**&amp;lt;your_access_token&amp;gt;**&quot;,
     ...
}
</pre></div>


<p>For security, tokens currently last two weeks and then users will need to re-authenticate with your app once the token expires, or automatically renew the access token using the refresh token flow.</p>
<h3 id="testing-an-app-as-client-owner">Testing an app as client owner<a class="headerlink" href="#testing-an-app-as-client-owner" title="Permanent link">&para;</a></h3>
<p>The following test should <em>fail</em> (i.e. no user listings shown) if you are not currently authenticated:</p>
<div class="codehilite"><pre><span></span>$ curl http://localhost:8000/api/users

<span class="o">{</span>
    <span class="s2">&quot;detail&quot;</span>: <span class="s2">&quot;Authentication credentials were not provided.&quot;</span>
<span class="o">}</span>
</pre></div>


<p>The following authenticated test should <em>succeed</em> and show you a list of users if you registered OAuth with a 
<em>superuser</em> account:    </p>
<div class="codehilite"><pre><span></span>$ curl -H <span class="s2">&quot;Authorization: Bearer &amp;lt;your_access_token&amp;gt;&quot;</span> http://localhost:8000/api/users
</pre></div>


<p>You can also test your access token by entering it at the top of your local interactive API Resource Documentation page at <a href="http://127.0.0.1:8000/api/docs/">http://127.0.0.1:8000/api/docs/</a>.</p>
<h2 id="basic-authentication">Basic authentication<a class="headerlink" href="#basic-authentication" title="Permanent link">&para;</a></h2>
<p>Due to the complexity of OAuth2 authentication, basic authentication can be useful during development. 
However, basic authentication requires trusting your sensitive credentials with API client applications and passing your username and password on every request, so it is strongly discouraged for production use.</p>
<h3 id="testing">Testing<a class="headerlink" href="#testing" title="Permanent link">&para;</a></h3>
<p>The following test should <em>fail</em> (i.e. no user listings shown) if you are not currently authenticated:</p>
<div class="codehilite"><pre><span></span>$ curl http://localhost:8000/api/users

<span class="o">{</span>
    <span class="s2">&quot;detail&quot;</span>: <span class="s2">&quot;Authentication credentials were not provided.&quot;</span>
<span class="o">}</span>
</pre></div>


<p>The following authenticated test should <em>succeed</em> and show you a list of users if you enter credentials of a Mezzanine <em>superuser</em> account:    </p>
<div class="codehilite"><pre><span></span>$ curl --user <span class="s1">&#39;&amp;lt;your_username&amp;gt;:&amp;lt;your_password&amp;gt;&#39;</span> http://localhost:8000/api/users
</pre></div>


<h2 id="session-authentication">Session authentication<a class="headerlink" href="#session-authentication" title="Permanent link">&para;</a></h2>
<p>Session authentication is enabled primarily for the Browsable Web API. If you wish to use session based authentication for write access as well as read access, you will need to setup a valid CSRF token for any PUT or POST requests. See the <a href="https://docs.djangoproject.com/en/dev/ref/csrf/#ajax">Django CSRF documentation</a> for more details.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="Mezzanine API" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Mezzanine API
              </span>
            </div>
          </a>
        
        
          <a href="../release-notes/" title="Release Notes" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Release Notes
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2015 - present <a href="https://twitter.com/GeorgeCushen">George Cushen</a>.
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/gcushen" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/GeorgeCushen" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.583bbe55.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-62992791-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>